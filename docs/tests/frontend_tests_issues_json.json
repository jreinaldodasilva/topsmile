[
  {
    "id": "FT-001",
    "title": "Race condition in AuthContext token verification",
    "severity": "CRITICAL",
    "file": "src/tests/contexts/AuthContext.test.tsx",
    "lineRange": "93-120",
    "description": "The authCheckInProgress flag is a local variable that doesn't persist between renders, allowing multiple simultaneous auth verification calls.",
    "reproduction": "Run: npm test -- AuthContext.test.tsx. Test 'verifies existing tokens on mount' fails intermittently. Add console.log in verifyAuth - multiple calls visible.",
    "suggestedFixPatchRef": "patches/001-authcontext-race-condition.patch",
    "testsSuggested": "Add test: 'should prevent concurrent auth verification calls'",
    "confidence": 90
  },
  {
    "id": "FT-002",
    "title": "MSW handlers return wrong response structure",
    "severity": "CRITICAL",
    "file": "src/mocks/handlers.ts",
    "lineRange": "9-30",
    "description": "MSW handlers return user.id instead of user._id, and expiresIn as string instead of number. Mismatches MongoDB conventions and backend expectations.",
    "reproduction": "Run integration test: npm test -- AuthFlow.test.tsx. Check console for 'Cannot read property _id of undefined' when tests run against real backend.",
    "suggestedFixPatchRef": "patches/002-msw-response-structure.patch",
    "testsSuggested": "Add API contract validation tests",
    "confidence": 95
  },
  {
    "id": "FT-003",
    "title": "Missing cleanup in Modal/Toast tests",
    "severity": "HIGH",
    "file": "src/tests/components/UI/Modal.test.tsx",
    "lineRange": "45-60",
    "description": "Modal tests set document.body.style.overflow='hidden' but don't clean up, causing subsequent test failures.",
    "reproduction": "Run: npm test -- Modal.test.tsx Toast.test.tsx. Second test suite may show unexpected styles.",
    "suggestedFixPatchRef": "patches/003-modal-toast-cleanup.patch",
    "testsSuggested": null,
    "confidence": 85
  },
  {
    "id": "FT-004",
    "title": "Accessibility tests use wrong tab attributes",
    "severity": "HIGH",
    "file": "src/tests/accessibility/AccessibilityIntegration.test.tsx",
    "lineRange": "36-48",
    "description": "Tests check for explicit tabIndex='0' on all form elements, but modern browsers handle tab order automatically. Test fails on correctly accessible forms.",
    "reproduction": "Run: npm test -- AccessibilityIntegration.test.tsx. Test 'should have proper keyboard navigation' may fail.",
    "suggestedFixPatchRef": "patches/004-accessibility-tab-order.patch",
    "testsSuggested": null,
    "confidence": 80
  },
  {
    "id": "FT-005",
    "title": "No tests for payment retry logic",
    "severity": "CRITICAL",
    "file": null,
    "lineRange": null,
    "description": "Payment retry logic (exponential backoff, retry limits, state expiration) is completely untested. High risk for production payment failures.",
    "reproduction": "Check src/tests/services/paymentService.test.ts - only happy path tests exist.",
    "suggestedFixPatchRef": null,
    "testsSuggested": "See tests_to_add.md - Payment Retry Logic section",
    "confidence": 95
  },
  {
    "id": "FT-006",
    "title": "Form validation tests missing edge cases",
    "severity": "MEDIUM",
    "file": "src/tests/components/UI/Form/FormValidation.test.tsx",
    "lineRange": "entire file",
    "description": "Tests cover basic validation but miss: special characters, SQL injection attempts, XSS vectors, internationalization, max length enforcement.",
    "reproduction": "Review test file - no edge case coverage.",
    "suggestedFixPatchRef": "patches/006-form-validation-edge-cases.patch",
    "testsSuggested": "See tests_to_add.md - Form Validation Edge Cases",
    "confidence": 85
  },
  {
    "id": "FT-007",
    "title": "ErrorContext doesn't test notification lifecycle",
    "severity": "HIGH",
    "file": "src/tests/contexts/ErrorContext.test.tsx",
    "lineRange": "80-100",
    "description": "Tests check notification creation/dismissal but don't verify auto-dismiss timing, max notification limits, or queue behavior.",
    "reproduction": "Run: npm test -- ErrorContext.test.tsx. No tests for notification expiration.",
    "suggestedFixPatchRef": "patches/007-errorcontext-lifecycle.patch",
    "testsSuggested": "Add tests for auto-dismiss, max notifications, queue overflow",
    "confidence": 85
  },
  {
    "id": "FT-008",
    "title": "PatientAuthContext missing token refresh tests",
    "severity": "HIGH",
    "file": "src/tests/contexts/PatientAuthContext.test.tsx",
    "lineRange": "entire file",
    "description": "Patient auth tests don't verify token refresh on 401, concurrent refresh prevention, or refresh token expiration handling.",
    "reproduction": "Review test file - no token refresh scenarios.",
    "suggestedFixPatchRef": "patches/008-patient-auth-refresh.patch",
    "testsSuggested": "Mirror admin auth token refresh tests for patient context",
    "confidence": 85
  },
  {
    "id": "FT-009",
    "title": "HTTP service lacks offline/timeout tests",
    "severity": "HIGH",
    "file": "src/tests/services/http.test.ts",
    "lineRange": "entire file",
    "description": "HTTP service tests don't cover: offline detection, request timeout, retry on network failure, request cancellation.",
    "reproduction": "Review test file - no network failure scenarios.",
    "suggestedFixPatchRef": "patches/009-http-offline-tests.patch",
    "testsSuggested": "See tests_to_add.md - HTTP Service Network Failures",
    "confidence": 85
  },
  {
    "id": "FT-010",
    "title": "Appointment booking missing conflict handling",
    "severity": "CRITICAL",
    "file": "src/tests/pages/Patient/Appointment/PatientAppointmentBooking.test.tsx",
    "lineRange": "90-120",
    "description": "Conflict handling test only checks error message, doesn't verify: time slot disabled in UI, alternative slots suggested, retry after new selection.",
    "reproduction": "Run: npm test -- PatientAppointmentBooking.test.tsx. Test incomplete.",
    "suggestedFixPatchRef": "patches/010-appointment-conflict-handling.patch",
    "testsSuggested": "See tests_to_add.md - Appointment Conflict Handling",
    "confidence": 90
  },
  {
    "id": "FT-011",
    "title": "useApiState hook tests commented out",
    "severity": "MEDIUM",
    "file": "src/tests/hooks/useApiState.test.ts",
    "lineRange": "1-60",
    "description": "All useApiState tests are commented out with no explanation. Hook is used in production but untested.",
    "reproduction": "Check file - all tests wrapped in /* */",
    "suggestedFixPatchRef": "patches/011-enable-useapistate-tests.patch",
    "testsSuggested": "Uncomment and fix existing tests",
    "confidence": 90
  },
  {
    "id": "FT-012",
    "title": "Custom matchers not imported in test files",
    "severity": "LOW",
    "file": "Multiple test files",
    "lineRange": null,
    "description": "Custom matchers defined in customMatchers.ts (toBeValidEmail, toBeValidUser, etc.) are not imported/used in any tests.",
    "reproduction": "Search codebase for 'toBeValidEmail' usage - only definition found.",
    "suggestedFixPatchRef": "patches/012-use-custom-matchers.patch",
    "testsSuggested": "Update tests to use custom matchers for validation",
    "confidence": 95
  },
  {
    "id": "FT-013",
    "title": "Jest fake timers not cleaned up properly",
    "severity": "MEDIUM",
    "file": "src/tests/components/UI/Toast.test.tsx",
    "lineRange": "10-15",
    "description": "Tests use jest.useFakeTimers() but don't restore real timers after each test, affecting subsequent tests.",
    "reproduction": "Run full test suite - timing-dependent tests may fail after Toast tests.",
    "suggestedFixPatchRef": "patches/013-timer-cleanup.patch",
    "testsSuggested": null,
    "confidence": 85
  },
  {
    "id": "FT-014",
    "title": "No E2E tests for admin dashboard workflows",
    "severity": "HIGH",
    "file": null,
    "lineRange": null,
    "description": "Cypress E2E tests cover login and patient booking but missing: admin contact management, patient creation, provider management, appointment calendar.",
    "reproduction": "Check cypress/e2e/ directory - only 6 test files, admin workflows missing.",
    "suggestedFixPatchRef": null,
    "testsSuggested": "See tests_to_add.md - E2E Admin Workflows",
    "confidence": 90
  },
  {
    "id": "FT-015",
    "title": "Missing tests for cross-tab logout sync",
    "severity": "MEDIUM",
    "file": "src/tests/contexts/AuthContext.test.tsx",
    "lineRange": "615-634",
    "description": "Cross-tab sync test only covers logout event, doesn't test: token updates, login sync, session timeout, race conditions during token refresh.",
    "reproduction": "Review test 'should sync logout across tabs' - incomplete coverage.",
    "suggestedFixPatchRef": "patches/015-cross-tab-sync.patch",
    "testsSuggested": "See tests_to_add.md - Cross-Tab Synchronization",
    "confidence": 80
  }
]